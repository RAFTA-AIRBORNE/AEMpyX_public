\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Keep aspect ratio if custom image width or height is specified
    \setkeys{Gin}{keepaspectratio}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{soul}      % strikethrough (\st) support for pandoc >= 3.0.0
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Tutorial1\_PRE\_data}
    
    
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@ges}{\let\PY@bf=\textbf\let\PY@it=\textit}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}
\end{tcolorbox}

    This script presents a work flow for ingesting AEM data for further
preprocessing. @author: vrath nov 2020

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{sys}
\PY{k+kn}{from} \PY{n+nn}{sys} \PY{k+kn}{import} \PY{n}{exit} \PY{k}{as} \PY{n}{error}
\PY{k+kn}{from} \PY{n+nn}{time} \PY{k+kn}{import} \PY{n}{process\PYZus{}time}
\PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k+kn}{import} \PY{n}{datetime}
\PY{k+kn}{import} \PY{n+nn}{warnings}

\PY{k+kn}{import} \PY{n+nn}{numpy}


\PY{n}{AEMPYX\PYZus{}ROOT} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{environ}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AEMPYX\PYZus{}ROOT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{mypath} \PY{o}{=} \PY{p}{[}\PY{n}{AEMPYX\PYZus{}ROOT}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/aempy/modules/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{AEMPYX\PYZus{}ROOT}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/aempy/scripts/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{k}{for} \PY{n}{pth} \PY{o+ow}{in} \PY{n}{mypath}\PY{p}{:}
    \PY{k}{if} \PY{n}{pth} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{sys}\PY{o}{.}\PY{n}{path}\PY{p}{:}
        \PY{n}{sys}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{pth}\PY{p}{)}

\PY{k+kn}{from} \PY{n+nn}{version} \PY{k+kn}{import} \PY{n}{versionstrg}
\PY{k+kn}{import} \PY{n+nn}{util}
\PY{k+kn}{import} \PY{n+nn}{aesys}

\PY{n}{AEMPYX\PYZus{}DATA} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{environ}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AEMPYX\PYZus{}DATA}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{version}\PY{p}{,} \PY{n}{\PYZus{}} \PY{o}{=} \PY{n}{versionstrg}\PY{p}{(}\PY{p}{)}
\PY{n}{titstrng} \PY{o}{=} \PY{n}{util}\PY{o}{.}\PY{n}{print\PYZus{}title}\PY{p}{(}\PY{n}{version}\PY{o}{=}\PY{n}{version}\PY{p}{,} \PY{n}{fname}\PY{o}{=}\PY{n+nv+vm}{\PYZus{}\PYZus{}file\PYZus{}\PYZus{}}\PY{p}{,} \PY{n}{out}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{titstrng}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{now} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{now}\PY{p}{(}\PY{p}{)}
\PY{n}{Header} \PY{o}{=} \PY{n}{titstrng}
\end{Verbatim}
\end{tcolorbox}

    Now some parameters controlling the work flow need to be defined.

\textit{OutInfo = True} will activate the output of some intermediate
information. This parameter, as well as most of the header, is common to
all tutorial scripts.

\begin{description}
\item[OutInfo = True] 
 will activate the output of some intermediate information.
This parameter, as well as most of the header, is common to all tutorial scripts.
\item[FileList = "search"] will choose a search of files to be read based on a 
string search (including wildcards). This parameter, as well as most of the header, 
is common to all tutorial scripts.
\item[SearchStr = ".xyz"] is only necessary when "search" is chosen.
\item[FileList = "set"] will require a list of files stored in the variable 
\textit{DataSet}. 
 
\end{description}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{OutInfo} \PY{o}{=} \PY{k+kc}{True}

\PY{n}{FileList} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{search}\PY{l+s+s2}{\PYZdq{}}  
\PY{n}{SearchStr} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.xyz}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{DataSet} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{c+c1}{\PYZsh{} FileList = \PYZdq{}set\PYZdq{}}
\PY{c+c1}{\PYZsh{} DataSet = [\PYZdq{}File1\PYZdq{}, \PYZdq{}File2\PYZdq{}]}
\end{Verbatim}
\end{tcolorbox}

    The following parameter control the treatment and output of data.
\textit{CheckNaN = True} will look for invalid data (e.g., ``*'' when
exported by Geosoft). \textit{MergeOut = True} and
\textit{LinesOut = True} will activate the output of full data set and
individual fligh tlines, respectively. The former is convenient for any
task requiring spatial information. The minimum number of sites can be
set, if flight lines are exported.

We suggest using the ``.npz'' ouput format, as it is the easiest and
fastest to be read by any python software, an uses compression, leading
to smaller file sizes.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{CheckNaN} \PY{o}{=} \PY{k+kc}{True}
\PY{n}{MergeOut} \PY{o}{=} \PY{k+kc}{True}   
\PY{n}{LinesOut} \PY{o}{=} \PY{k+kc}{True}  
\PY{n}{LinesMin} \PY{o}{=} \PY{l+m+mi}{30}

\PY{n}{OutFileFmt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.npz}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZdq{}.asc\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    The following two parameters allow to change the projections (now
redundant, as this is already done in module \textit{aesys.py}). GSI
chose the ITM system (EPSG=2157), which is not known to many useful
software, e.g., google earth. Within \textit{AEMpyX}, the coordinates
are in UTM (Zone 29N, EPSG==32629). Flight lines should also be stored
in the same direction, setting \textit{CorrectDirection=True}. This is
convenient for practical reasons, as comparing plots.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{SetProj} \PY{o}{=} \PY{k+kc}{False}
\PY{k}{if} \PY{n}{SetProj}\PY{p}{:}
    \PY{n}{ProjInp} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}
    \PY{n}{ProjOut} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{TellusAng} \PY{o}{=} \PY{l+m+mf}{345.}
\PY{n}{Spread} \PY{o}{=} \PY{l+m+mf}{5.}
\PY{n}{CorrectDirection} \PY{o}{=} \PY{k+kc}{True}
\end{Verbatim}
\end{tcolorbox}

    The following block defines the choice of date to be processed. Most
often the choice is simply a rectangle, as demonstrated here. The
original data files provided by GSI are too large to be stored with git,
thus need to be downloaded from
https://www.gsi.ie/en-ie/data-and-maps/Pages/Geophysics.aspx, and stored
in a local directory of the user's choice (see below).

    We need define some necessary paramters controlling the reading of the
original data, and the choice of an appropriate subset. In this case it
is a rectangle covering the outcrops of black shapes in Co.~Limerick,
south of the Shannon estuary.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{RectCorners} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{PolyFiles} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{DataSelect} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AEM\PYZus{}system} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aem05}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{NN}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{o}{=} \PY{n}{aesys}\PY{o}{.}\PY{n}{get\PYZus{}system\PYZus{}params}\PY{p}{(}\PY{n}{AEM\PYZus{}system}\PY{p}{)}
\PY{n}{nD} \PY{o}{=} \PY{n}{NN}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}

\PY{n}{AEMPYX\PYZus{}DATA} \PY{o}{=} \PY{n}{AEMPYX\PYZus{}ROOT}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/work/}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{DataSelect} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rectangle}\PY{l+s+s2}{\PYZdq{}}   \PY{c+c1}{\PYZsh{} \PYZdq{}Polygon\PYZdq{}, \PYZdq{}Intersection\PYZdq{}, \PYZdq{}Union\PYZdq{}}
\PY{n}{InDatDir} \PY{o}{=} \PY{n}{AEMPYX\PYZus{}DATA}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/Limerick/}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{OutDatDir} \PY{o}{=} \PY{n}{InDatDir}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/raw/}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{RectCorners} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{486000.}\PY{p}{,} \PY{l+m+mf}{5815000.}\PY{p}{,} \PY{l+m+mf}{498000.}\PY{p}{,} \PY{l+m+mf}{5828000.}\PY{p}{]} 
\PY{n}{InSurvey} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A5}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{OutStrng} \PY{o}{=} \PY{n}{InSurvey}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}rect\PYZus{}shale}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    After this, generally no code changes are necessary.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Data read from dir:  }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{InDatDir}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Data written to dir: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{OutDatDir}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Flightline ID string: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{OutStrng}\PY{p}{)}

\PY{k}{if} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{search}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{FileList}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{DataSet} \PY{o}{=} \PY{p}{[}\PY{p}{]}

    \PY{n}{files} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{InDatDir}\PY{p}{)}
    \PY{k}{for} \PY{n}{entry} \PY{o+ow}{in} \PY{n}{files}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} print(entry)}
        \PY{k}{if} \PY{n}{SearchStr} \PY{o+ow}{in} \PY{n}{entry}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{DataSet}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{entry}\PY{p}{)}

\PY{n}{DataSet} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{DataSet}\PY{p}{)}
\PY{n}{ns} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{n}{DataSet}\PY{p}{)}

\PY{k}{if} \PY{o+ow}{not} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{isdir}\PY{p}{(}\PY{n}{OutDatDir}\PY{p}{)}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{File: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ does not exist, but will be created}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{OutDatDir}\PY{p}{)}
    \PY{n}{os}\PY{o}{.}\PY{n}{mkdir}\PY{p}{(}\PY{n}{OutDatDir}\PY{p}{)}


\PY{n}{dcount}\PY{o}{=}\PY{l+m+mi}{0}
\PY{k}{for} \PY{n}{dset} \PY{o+ow}{in} \PY{n}{DataSet}\PY{p}{:}
    \PY{n}{dcount}\PY{o}{=}\PY{n}{dcount}\PY{o}{+}\PY{l+m+mi}{1}
    \PY{n}{start} \PY{o}{=} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)}
    \PY{n}{file} \PY{o}{=} \PY{n}{InDatDir} \PY{o}{+} \PY{n}{dset}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Raw data read from: }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{file}\PY{p}{)}
    \PY{n}{Datar} \PY{o}{=} \PY{n}{aesys}\PY{o}{.}\PY{n}{read\PYZus{}survey\PYZus{}data}\PY{p}{(}\PY{n}{DatFile}\PY{o}{=}\PY{n}{file}\PY{p}{,} \PY{n}{Survey}\PY{o}{=}\PY{n}{InSurvey}\PY{p}{,} \PY{n}{OutInfo}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{k}{if} \PY{n}{dcount} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
        \PY{n}{Data} \PY{o}{=} \PY{n}{Datar}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{Data} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{(}\PY{n}{Data}\PY{p}{,} \PY{n}{Datar}\PY{p}{)}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Read time taken = }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{start}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{s }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}


\PY{k}{if} \PY{n}{SetProj}\PY{p}{:}
    \PY{n}{start} \PY{o}{=} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)}
    \PY{n}{itm\PYZus{}e} \PY{o}{=} \PY{n}{Data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{itm\PYZus{}n} \PY{o}{=} \PY{n}{Data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}
    \PY{n}{utm\PYZus{}e}\PY{p}{,} \PY{n}{utm\PYZus{}n} \PY{o}{=} \PY{n}{util}\PY{o}{.}\PY{n}{project\PYZus{}itm\PYZus{}to\PYZus{}utm}\PY{p}{(}\PY{n}{itm\PYZus{}e}\PY{p}{,} \PY{n}{itm\PYZus{}n}\PY{p}{)} \PY{c+c1}{\PYZsh{}, utm\PYZus{}zone=32629)}
    \PY{n}{Data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{utm\PYZus{}e}
    \PY{n}{Data}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{n}{utm\PYZus{}n}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ITM Transformed to UTM}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Projection time taken = }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{start}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{s }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    Data subsets based on rectangle, polygons or operators on polygons

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{start} \PY{o}{=} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{In: }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{numpy}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{Data}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Data select is }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{DataSelect}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{k}{if} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rec}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{DataSelect}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{head} \PY{o}{=} \PY{n}{aesys}\PY{o}{.}\PY{n}{grow\PYZus{}header}\PY{p}{(}\PY{n}{Header}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Subset: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{RectCorners}\PY{p}{)}\PY{p}{)}
    \PY{n}{start} \PY{o}{=} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)}
    \PY{n}{Rect} \PY{o}{=} \PY{n}{util}\PY{o}{.}\PY{n}{extract\PYZus{}data\PYZus{}rect}\PY{p}{(}\PY{n}{Data}\PY{p}{,} \PY{n}{RectCorners}\PY{p}{)}
    \PY{k}{if} \PY{n}{Rect}\PY{o}{.}\PY{n}{size} \PY{o}{!=} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{Data} \PY{o}{=} \PY{n}{Rect}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{error}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{No data found in rectangle!}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{k}{if} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{pol}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{DataSelect}\PY{p}{:}
    \PY{n}{head} \PY{o}{=} \PY{n}{aesys}\PY{o}{.}\PY{n}{grow\PYZus{}header}\PY{p}{(}\PY{n}{Header}\PY{p}{,}
            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ | Subset: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{DataSet}\PY{p}{)}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{: }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{PolyFiles}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
    \PY{n}{Polygon} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{PolyFiles}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{allow\PYZus{}pickle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Poly}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{start} \PY{o}{=} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)}
    \PY{n}{Poly}\PY{o}{=} \PY{n}{util}\PY{o}{.}\PY{n}{extract\PYZus{}data\PYZus{}poly}\PY{p}{(}\PY{n}{Data}\PY{p}{,} \PY{n}{Polygon}\PY{p}{,} \PY{n}{method}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{shp}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{if} \PY{n}{Poly}\PY{o}{.}\PY{n}{size} \PY{o}{!=} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{Data} \PY{o}{=} \PY{n}{Poly}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{error}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{No data found in polygon!}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{k}{if} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{uni}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{DataSelect}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o+ow}{or} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{int}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{DataSelect}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{k}{for} \PY{n}{polyfile} \PY{o+ow}{in} \PY{n}{PolyFiles}\PY{p}{:}
        \PY{n}{head} \PY{o}{=} \PY{n}{aesys}\PY{o}{.}\PY{n}{grow\PYZus{}header}\PY{p}{(}\PY{n}{Header}\PY{p}{,}
                \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ | Subset: }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{DataSelect}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{: }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{polyfile}\PY{p}{)}
    \PY{n}{Polygon1} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{PolyFiles}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{allow\PYZus{}pickle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Poly}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{Polygon2} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{PolyFiles}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{allow\PYZus{}pickle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Poly}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{start} \PY{o}{=} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)}
    \PY{n}{Polygon}\PY{o}{=} \PY{n}{util}\PY{o}{.}\PY{n}{modify\PYZus{}polygon}\PY{p}{(}\PY{p}{[}\PY{n}{Polygon1}\PY{p}{,} \PY{n}{Polygon2}\PY{p}{]}\PY{p}{,} \PY{n}{Operator}\PY{o}{=}\PY{n}{DataSelect}\PY{p}{)}
    \PY{n}{Poly}\PY{o}{=} \PY{n}{util}\PY{o}{.}\PY{n}{extract\PYZus{}data\PYZus{}poly}\PY{p}{(}\PY{n}{Data}\PY{p}{,} \PY{n}{Polygon}\PY{p}{,} \PY{n}{method}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{shp}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{if} \PY{n}{Poly}\PY{o}{.}\PY{n}{size} \PY{o}{!=} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{Data} \PY{o}{=} \PY{n}{Poly}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{error}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{No data found in polygons!}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Data select time taken = }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{start}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{s }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Out: }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{numpy}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{Data}\PY{p}{)}\PY{p}{)}\PY{p}{)}

\PY{k}{if} \PY{n}{MergeOut}\PY{p}{:}
    \PY{n}{head} \PY{o}{=} \PY{n}{aesys}\PY{o}{.}\PY{n}{grow\PYZus{}header}\PY{p}{(}\PY{n}{Header}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{All Lines}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{f} \PY{o}{=} \PY{n}{OutDatDir} \PY{o}{+} \PY{n}{OutStrng}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}Full}\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{OutFileFmt}
    \PY{n}{aesys}\PY{o}{.}\PY{n}{write\PYZus{}aempy}\PY{p}{(}\PY{n}{File}\PY{o}{=}\PY{n}{f}\PY{p}{,} \PY{n}{Data}\PY{o}{=}\PY{n}{Data}\PY{p}{,} \PY{n}{System}\PY{o}{=}\PY{n}{AEM\PYZus{}system}\PY{p}{,}
                    \PY{n}{Header}\PY{o}{=}\PY{n}{head}\PY{p}{,} \PY{n}{OutInfo}\PY{o}{=}\PY{n}{OutInfo}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{All data written to File: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{f} \PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Header written: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{head}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{time taken = }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{start}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{s }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}


\PY{k}{if} \PY{n}{LinesOut}\PY{p}{:}
    \PY{n}{bad\PYZus{}files} \PY{o}{=} \PY{l+m+mi}{0}
    \PY{n}{startlines} \PY{o}{=} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)}
    \PY{n}{Lines} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{numpy}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{n}{Data}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZgt{}Flight lines in data set:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{Lines}\PY{p}{)}
    \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{Lines}\PY{p}{:}
        \PY{n}{tmp} \PY{o}{=} \PY{n}{Data}\PY{p}{[}\PY{n}{numpy}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{Data}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{s}\PY{p}{)}\PY{p}{,} \PY{p}{:}\PY{p}{]}
        \PY{n}{ns} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{tmp}\PY{p}{)}
        \PY{n}{tmp} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{tmp}\PY{p}{,} \PY{p}{(}\PY{n}{ns}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{ns}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{OutInfo: }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{numpy}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{tmp}\PY{p}{)}\PY{p}{)}\PY{p}{)}

        \PY{k}{if} \PY{n}{numpy}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{n}{tmp}\PY{p}{)}\PY{o}{\PYZlt{}}\PY{o}{=}\PY{n}{nD}\PY{o}{*}\PY{n}{LinesMin}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Not enough data! Not written}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{k}{continue}

        \PY{k}{if} \PY{n}{CheckNaN}\PY{p}{:}
                \PY{n}{nn} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{count\PYZus{}nonzero}\PY{p}{(}\PY{n}{numpy}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{tmp}\PY{p}{)}\PY{p}{)}
                \PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{nn}\PY{p}{)}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ NaNs in Data Block}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                \PY{k}{if} \PY{n}{nn} \PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{:}
                    \PY{n}{bad\PYZus{}files} \PY{o}{=} \PY{n}{bad\PYZus{}files}\PY{o}{+}\PY{l+m+mi}{1}
                    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Too many NaNs = }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{nn}\PY{p}{)}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ in block, not written}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                    \PY{k}{continue}


        \PY{k}{if} \PY{n}{CorrectDirection}\PY{p}{:}
            \PY{n}{AngLimits} \PY{o}{=} \PY{p}{[}\PY{n}{TellusAng}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.}\PY{p}{,} \PY{n}{TellusAng}\PY{o}{+}\PY{l+m+mf}{5.} \PY{p}{]}
            \PY{n}{nd} \PY{o}{=}\PY{n}{numpy}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{tmp}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
            \PY{n}{spoint} \PY{o}{=} \PY{p}{[}\PY{n}{tmp}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{nd}\PY{o}{*}\PY{l+m+mf}{0.3}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{tmp}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{nd}\PY{o}{*}\PY{l+m+mf}{0.3}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]}
            \PY{n}{epoint} \PY{o}{=} \PY{p}{[}\PY{n}{tmp}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{nd}\PY{o}{*}\PY{l+m+mf}{0.6}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{tmp}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{nd}\PY{o}{*}\PY{l+m+mf}{0.6}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]}
            \PY{n}{ang}\PY{p}{,} \PY{n}{\PYZus{}} \PY{o}{=} \PY{n}{util}\PY{o}{.}\PY{n}{get\PYZus{}direction\PYZus{}angle}\PY{p}{(}\PY{n}{spoint}\PY{p}{,} \PY{n}{epoint}\PY{p}{)}
            \PY{k}{if} \PY{p}{(}\PY{n}{ang} \PY{o}{\PYZlt{}} \PY{n}{TellusAng}\PY{o}{\PYZhy{}}\PY{n}{Spread}\PY{p}{)} \PY{o+ow}{or} \PY{p}{(}\PY{n}{ang} \PY{o}{\PYZgt{}} \PY{n}{TellusAng}\PY{o}{+}\PY{n}{Spread}\PY{p}{)}\PY{p}{:}
                \PY{n}{tmp} \PY{o}{=} \PY{n}{numpy}\PY{o}{.}\PY{n}{flipud}\PY{p}{(}\PY{n}{tmp}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ Angle = }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{ang}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                    \PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ not in interval }\PY{l+s+s2}{\PYZdq{}}
                    \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{AngLimits}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ \PYZhy{} }\PY{l+s+s2}{\PYZdq{}}
                    \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{AngLimits}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Flightline direction has been reversed.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                \PY{n}{chdir} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, direction has been reversed}\PY{l+s+s2}{\PYZdq{}}
            \PY{k}{else}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Flightline direction is approx. 345 degrees}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                \PY{n}{chdir} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}

        \PY{n}{head} \PY{o}{=} \PY{n}{aesys}\PY{o}{.}\PY{n}{grow\PYZus{}header}\PY{p}{(}\PY{n}{Header}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Flightline }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{p}{)}

        \PY{n}{f} \PY{o}{=} \PY{n}{OutDatDir} \PY{o}{+} \PY{n}{OutStrng} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}FL}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{+}\PY{n}{OutFileFmt}
        \PY{n}{aesys}\PY{o}{.}\PY{n}{write\PYZus{}aempy}\PY{p}{(}\PY{n}{File}\PY{o}{=}\PY{n}{f}\PY{p}{,} \PY{n}{Data}\PY{o}{=}\PY{n}{tmp}\PY{p}{,} \PY{n}{System}\PY{o}{=}\PY{n}{AEM\PYZus{}system}\PY{p}{,}
                        \PY{n}{Header}\PY{o}{=}\PY{n}{head}\PY{p}{,} \PY{n}{OutInfo}\PY{o}{=}\PY{n}{OutInfo}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Flight line written to File: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{f}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Header written: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{head}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{time taken = }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{start}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{s }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Flight line data, time taken = }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
          \PY{n}{process\PYZus{}time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{startlines}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{s }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
